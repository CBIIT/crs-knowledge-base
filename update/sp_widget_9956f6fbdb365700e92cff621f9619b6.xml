<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope,$http) {
  /* widget controller */
		var template = {"u_kb_template_top_accomplishment":['Cancer Site/Type','Research Type','Description','References','Involved organization', 'DOC'],
					 "u_kb_template_collaboration_report":['Type','NIH Partners','Federal Partners','Description'],
					 "u_kb_template_significant_item": ['Cancer Site/Type', 'Congressional Language','Background','Recent Accomplishments','New Opportunities'],
					 "u_kb_template_triennial_report": ['Background','Methods','Results', 'Conclusions']
				   };
	
  var c = this;
	var sessionId = c.data.info.sessionId;
	var userId = c.data.info.userId;
	var data = {};
	var columns = [];
	var title = "";
	
	window.displayData = function(doc_id, template_id){
		var req = {
				url: '/api/x_26385_crs_kd/export/getDocumentById',
				method: 'GET',
				beforeSend: function(xhr){xhr.setRequestHeader('X-UserToken', sessionId); },
				headers: {
					'Content-Type': 'application/json'
				},
				params: {'id': doc_id, 'name': template_id}
		};
		$http(req).then(handleResponse, handleError);

		function handleResponse(response){
			$scope.data = response.data.result;
			$scope.title = $scope.data['Short description'];
			$scope.columns = template[template_id];
			console.log($scope.data);
		}
		function handleError(response){
			console.error(response);
			alert("ERROR!");
		}

			 $('#document_content').modal('show');	
		}
}]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>crs-kd-content</id>
        <internal>false</internal>
        <link/>
        <name>[crs] KD Content</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	var session_id = gs.getSession().getSessionToken();
	var my_sys_id = gs.getUserID();

	
	data.info = {
		userId: my_sys_id,
		sessionId: session_id
	};

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>yuw5@nih.gov</sys_created_by>
        <sys_created_on>2018-06-26 20:11:30</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>9956f6fbdb365700e92cff621f9619b6</sys_id>
        <sys_mod_count>136</sys_mod_count>
        <sys_name>[crs] KD Content</sys_name>
        <sys_package display_value="CRS Knowledge Database" source="x_26385_crs_kd">404e613b4f9213007221e321a310c738</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="CRS Knowledge Database">404e613b4f9213007221e321a310c738</sys_scope>
        <sys_update_name>sp_widget_9956f6fbdb365700e92cff621f9619b6</sys_update_name>
        <sys_updated_by>zhoujim@nih.gov</sys_updated_by>
        <sys_updated_on>2018-06-27 00:15:13</sys_updated_on>
        <template><![CDATA[<div>
  <div id="document_content" class="modal fade" data-keyboard="false" data-backdrop="static" style="overflow-y:auto; overflow-x: auto;">   
	<div class="modal-dialog">
  	<div class="modal-content" id="content" style="width:900px; height:auto; overflow-y:auto; overflow-x: hidden;">
         <div class="modal-header">
               <button type="button" class="close" data-dismiss="modal" ng-click="cancel()" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
               </button>
               <h4  class="modal-title">{{title}}</h4>
         </div>      
         <div class="modal-body">
           <div ng-repeat="item in columns track by $index">
              <h4>{{item}}</h4> 
              <div ng-bind-html="data[item]"></div> 
           </div> 
      	 </div>
         <div class="modal-footer">
        	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      	 </div>
    </div>
  </div>
</div>
]]></template>
    </sp_widget>
</record_update>
