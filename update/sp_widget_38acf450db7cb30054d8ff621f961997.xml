<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, $location, NERDSubmission) {
  /* widget controller */
  var c = this;
	var s = $location.search();
	
	c.save = false;
	c.saving = false;
	c.save_text = "Save";
	
	c.kc = [];
	c.kc.push({id:'0',label:'Please select a template'});
	c.kc.push({id:'u_kb_template_top_accomplishment',label:'NERD > Top Accomplishments'});
	c.kc.push({id:'u_kb_template_gpra',label:'NERD > GPRA', kb:'f5644dcadb54ab0054d8ff621f9619d7'});
	c.kc.push({id:'u_kb_template_significant_items',label:'NERD > Significant Items'});
	c.kc.push({id:'u_kb_template_final_reports',label:'NERD > Final Reports'});
	c.kc.push({id:'u_kb_template_literature_summary',label:'NERD > Literature Summary'});
	c.kc.push({id:'u_kb_template_miscellaneous',label:'NERD > Miscellaneous'});
	c.kc.push({id:'u_kb_template_analysis',label:'CRS Internal > Analysis'});
	c.kc.push({id:'u_kb_template_miscellaneous_int',label:'CRS Internal > Miscellaneous'});
	c.kc.push({id:'u_kb_template_presentations',label:'CRS Internal > Presentations'});
	c.kc.push({id:'u_kb_template_miscellaneous_me',label:'Moonshot Evaluation > Miscellaneous'});
	
	c.attachments = [];
	
	/*
	c.testMceOptions = {
		menubar: false,
		statusbar: false,
		setup: function(ed) {
			ed.addCommand('uploadImage', function() {
				
				var base64 = "data:image/gif;base64,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";
				var args = tinymce.extend({}, {
                        id: "image_1",
												src: base64, // encodeURI("/" + response.sys_id + ".iix"),
                        style: "max-width: 100%; max-height: 480px;"
                    });
				ed.execCommand('mceInsertContent', false, ed.dom.createHTML('img', args), {
					skip_undo: 1
				});
				
			});
			ed.addButton('image', {
				icon: 'image',
				tooltip: 'Insert image',
				onclick: function(e) {
					ed.execCommand('uploadImage');
				}
			})
				
		},
		toolbar: 'bold italic image '
	}
	
	*/
	c.mceOptions = {
		resize: true,
		content_css : '/133734fbdb4ab30054d8ff621f9619f2.spcssdbx',
		height: 200,
		autoresize_min_height: 200,
		menubar: "table",
		statusbar: false,
		plugins: 'link autoresize table',
		default_link_target: "_blank",
		toolbar: 'undo redo | fontsizeselect bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | link | table',
		table_default_styles: {
			'width': '50%',
			'border-collapse': 'collapse',
			'table-layout': 'fixed'
		}
  }
	
	if(s.template){
		c.data.selectedKnowledgeCategory = {id:s.template};
	}
	else{
		c.data.selectedKnowledgeCategory = {id:'0',label:'Please select a template:'};
	}
	
	c.transform = function(field, arr_1, arr_2){
		if(arr_1 == undefined && arr_2 == undefined){
			return;
		}
		var sub = [];
		if(c.data[field]){
			arr_1.forEach(function(idx){
				c.schema[idx].display = true;
				if(c.schema[idx].type == 'boolean' && c.schema[idx].displayWhenTrue !== undefined){
					sub.push(idx);
				}
			});
			arr_2.forEach(function(idx){
				c.schema[idx].display = false;
				if(c.schema[idx].type == 'boolean' && c.schema[idx].displayWhenTrue !== undefined){
					sub.push(idx);
				}
			});
		}
		else{
			arr_1.forEach(function(idx){
				c.schema[idx].display = false;
				if(c.schema[idx].type == 'boolean' && c.schema[idx].displayWhenTrue !== undefined){
					sub.push(idx);
				}
			});
			arr_2.forEach(function(idx){
				c.schema[idx].display = true;
				if(c.schema[idx].type == 'boolean' && c.schema[idx].displayWhenTrue !== undefined){
					sub.push(idx);
				}
			});
		}
		if(sub.length > 0){
			sub.forEach(function(s){
				if(!c.schema[s].display){
					c.data[c.schema[s].field] = false;
					c.transform(c.schema[s].field, c.schema[s].displayWhenTrue, c.schema[s].displayWhenFalse);
				}
			});
		}
		
	};
	
	c.reorderItems = function(items){
		var result = [];
		var len = items.length;
		var rows = Math.floor(len/3);
		if(len % 3 != 0){
			rows ++;
		}
		var k = 0, i = 0;
		for(k = 0; k< rows ; k++){
			for(i = k; i< rows * 3; i = i + rows){
				if(i >= len){
					result.push('');
				}
				else{
					result.push(items[i]);
				}
				
			}
		}
		return result;
	};
	
	c.swithKnowledgeCategory = function(){
		var params = c.data.selectedKnowledgeCategory;
		if(params.id == "0"){
			c.kb = '';
			c.schema = [];
			c.items = {};
			c.selected = {};
			c.save = false;
		}
		else{
			NERDSubmission.getSchema(params, c.data.sessionId).then(function(res){
				var result = res.data.result;
				if(result){
					c.kb = result.kb;
					c.schema = result.schema;
					c.items = {};
					c.selected = {};
					result.schema.forEach(function(item){
						if(item.type == "checkbox"){
							item.items = c.reorderItems(item.items);
							c.items[item.field] = item.items;
							c.selected[item.field] = [];
						}
					});
					c.attachments = [{name: 'file2upload'}];
					c.save = true;
					
				}
				else{
					c.kb = '';
					c.schema = [];
					c.items = {};
					c.selected = {};
					c.save = false;
				}
				$scope.$apply();
			},function(error){
				console.log(error);
			});
		}
		
	};
	
	c.addAttachment = function(event){
		var el = event.currentTarget;
		//c.attachments.pop();
    var node = el.parentNode;
		var content = angular.element("<div style=\"margin-bottom:10px;\">"
			+"<input type=\"file\" style=\"width:80%;float:left;cursor: pointer;\" name=\"file2upload\" class=\"form-control\">"
			+"<span class=\"attachment-action\" ng-click=\"c.addAttachment($event)\"><i class=\"fa fa-plus\"></i></span>"
			+"<span class=\"attachment-action\" ng-click=\"c.deleteAttachment($event)\" ng-show = \"c.attachments.length > 1\"><i class=\"fa fa-minus\"></i></span>"
			+"</div>");
		content.insertAfter(node);
		c.attachments.push({name: 'file2upload'});
		$compile(content)($scope);
	};
	
	c.deleteAttachment = function(event){
		var el = event.currentTarget;
		c.attachments.pop();
    el.parentNode.parentNode.removeChild(el.parentNode);
	};
	
	c.toggle = function (item, list) {
    var idx = list.indexOf(item);
    if (idx > -1) {
      list.splice(idx, 1);
    }
    else {
      list.push(item);
    }
  };
	
	c.exists = function (item, list) {
		return list.indexOf(item) > -1;
  };

	c.isIndeterminate = function(field) {
    return (c.selected[field].length !== 0 &&
        c.selected[field].length !== c.items[field].length);
  };
	
	c.isChecked = function(field) {
		return c.selected[field].length === c.items[field].length;
  };

  c.toggleAll = function(field) {
    if (c.selected[field].length === c.items[field].length) {
      c.selected[field] = [];
    } else if (c.selected[field].length === 0 || c.selected[field].length > 0) {
      c.selected[field] = c.items[field].slice(0);
    }
  };
	
	function pReadFile(file){
		return new Promise(function(resolve, reject){
			var fr = new FileReader();  
			fr.onload = function(){
				var encoded = fr.result.replace(/^data:(.*;base64,)?/, '');
				if ((encoded.length % 4) > 0) {
					encoded += '='.repeat(4 - (encoded.length % 4));
				}
				resolve(encoded);
			};
			fr.readAsDataURL(file);
		});
	}
	
	function readFile(file, callback) {
		var fileReader = new FileReader();
		fileReader.onload = function() {
			//var result = fileReader.result.replace('data:application/pdf;base64,', '');
			var encoded = fileReader.result.replace(/^data:(.*;base64,)?/, '');
      if ((encoded.length % 4) > 0) {
        encoded += '='.repeat(4 - (encoded.length % 4));
      }
			callback(encoded);
		}
		fileReader.readAsDataURL(file); //file must be base64
	}
	
	c.saveAttachment = function(input,template, sys_id, sessionId, idx){
		if(input.length <= idx){
			return new Promise(function(resolve, reject){
								resolve("1");
							});
		}
		else if(input[idx].files.length == 0){
			return c.saveAttachment(input,template, sys_id, sessionId, idx + 1);
		}
		else{
			var file = input[idx].files[0];
			return new Promise(function(resolve, reject){
				pReadFile(file).then(function(base64){
					var attach = {
						template: template,
						sys_id: sys_id,
						fileName: file.name,
						fileType: file.type,
						fileContents : base64
					};
					NERDSubmission.saveAttachment(attach, sessionId).then(function(res){
						var result = res.data.result;
						c.saveAttachment(input, template, sys_id, sessionId, idx + 1).then(function(dt){
							resolve(dt);
						},
						function(error){
							console.log(error);
						});
						
					},function(error){
						console.log(error);
					});
				},function(error){
					console.log(error);
				});
			});
			
			
		}
	};
	
	c.saveDraft = function(){
		var input = $('input[name=file2upload]');
		var length = input.length;
		var pass = true;
		var errorMessage = "";
		var element;
		for(var k = 0; k< length; k++){
			element = input[k];
			if(element.files.length == 0){
				continue;
			}
			var file = element.files[0];
			if(file.type !== 'application/pdf' && file.type !== 'application/vnd.ms-powerpoint' 
				 && file.type !== 'application/vnd.openxmlformats-officedocument.presentationml.presentation'
				 && file.type !== 'application/msword'
				 && file.type !== 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'){
				pass = pass && false;
				errorMessage = 'Please attach a PDF/PPT/Word file.';
			}
			else if(file.size > 18874368){
				pass = pass && false;
				errorMessage = 'Please make sure file size is less than 18MB.';
			}
		};
		
		if(!c.data.x_26385_crs_kd_u_kb_title || c.data.x_26385_crs_kd_u_kb_title.trim() == ""){
			window.showMessageBox("Please enter a title for you submission.");
		}
		else if(!pass){
			window.showMessageBox(errorMessage);
		}
		else{
			var params = {};
				
			c.schema.forEach(function(item){
				if(item.display !== undefined && !item.display){
					params[item.field] = item.type == 'boolean' ? "No" : "";
				}
				else if(item.type == 'boolean'){
					params[item.field] = (c.data[item.field] == undefined || c.data[item.field] == "" || !c.data[item.field]) ? "No" : "Yes";
				}
				else if(item.type == 'date'){
					if(c.data[item.field] == undefined){
						params[item.field] = "";
					}
					else if(c.data[item.field] !== ""){
						params[item.field] = new Date(c.data[item.field]).toISOString().substring(0, 10);
					}
					
				}
				else if(item.type == 'checkbox'){
					if(c.selected[item.field].length > 0){
						params[item.field] = '{'+c.selected[item.field].join("},{") + '}';
					}
					else{
						params[item.field] = "";
					}
				}
				else if(item.type == 'string' || item.type == 'html'){
					params[item.field] = c.data[item.field];
				}
				else if(item.type == 'radio'){
					params[item.field] = c.data[item.field];
				}
				else if(item.type == 'customize'){
					if(item.label == 'References'){
						var pmids = c.data['pmids'];
						var links = [];
						if(pmids && pmids.trim() !== ""){
							var p = pmids.trim().split(',');
							p.forEach(function(t){
								if(t !== ""){
									//var lk = "https://www.ncbi.nlm.nih.gov/pubmed/" + t;
									links.push(t);
								}
							});
						}
						params[item.field] = links.join(',');
					}
					else if(item.label == 'Funding'){
						var funding = [];
						funding.push((c.data['Funding'] != undefined && c.data['Funding']) ? "Yes":"No");
						funding.push(c.data['Funding_info']);
						params[item.field] = funding.join('|');
					}
					
				}
				else if(item.type == 'file'){

				}
				
			});
			
			
			
			var template = c.data.selectedKnowledgeCategory.id;
			
			c.saving = true;
			c.save_text = "Saving...";

			NERDSubmission.saveDraft(template, params, c.data.sessionId).then(function(res){
					var result = res.data.result;
				  if(result == "0"){
						return new Promise(function(resolve, reject){
								resolve("0");
							});
					}
					else{
						return c.saveAttachment(input, template, result, c.data.sessionId, 0);
					}
				},function(error){
					console.log(error);
				}).then(function(rp){
				  c.saving = false;
					c.save_text = "Save";
					var v = rp;
				  if(v == "1"){
						//window.showMessageBox("Article has been successfully saved.");
						window.showMessageBox("Article has been successfully saved.",{xpage:'kd_search', kb_knowledge_base:c.kb, template: null});
					}
					else{
						window.showMessageBox("Failed to save your Article.");
					}
				  
				}, function(error){
						console.log(error);
				});;
		}
		
	};
	
	c.goBacktoSubmissions = function(){
		s.xpage = 'kd_search';
		s.kb_knowledge_base = c.kb;
		s.template = null;
		$location.search(s).replace();
	}
	
	c.swithKnowledgeCategory();
	
	

  
}]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>crs-kd-new-submission</id>
        <internal>false</internal>
        <link/>
        <name>[crs] KD New Submission</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	data.sessionId = gs.getSession().getSessionToken();
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>yuw5@nih.gov</sys_created_by>
        <sys_created_on>2019-04-09 20:37:48</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>38acf450db7cb30054d8ff621f961997</sys_id>
        <sys_mod_count>341</sys_mod_count>
        <sys_name>[crs] KD New Submission</sys_name>
        <sys_package display_value="CRS Knowledge Database" source="x_26385_crs_kd">404e613b4f9213007221e321a310c738</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="CRS Knowledge Database">404e613b4f9213007221e321a310c738</sys_scope>
        <sys_update_name>sp_widget_38acf450db7cb30054d8ff621f961997</sys_update_name>
        <sys_updated_by>yuw5@nih.gov</sys_updated_by>
        <sys_updated_on>2019-06-21 21:03:55</sys_updated_on>
        <template><![CDATA[<div id="crs-article">
  <div class="container">
    <div class="row row-space">
          <div class="col-md-12 article-block">
						<div class="block-header">
              <select class="form-control" name="kcSelect" id="kcSelect" ng-options="option.label for option in c.kc track by option.id"
                            ng-model="c.data.selectedKnowledgeCategory" ng-change="c.swithKnowledgeCategory()" style="font-weight:bold;">
              </select>
            </div>      
            <div class="block-body"> 
              <div ng-repeat="entry in c.schema track by $index" id="{{entry.field}}" ng-show=" entry.display == undefined || entry.display ">
                <h4 style="font-weight:bold;"><i class="fa fa-asterisk" aria-hidden="true" ng-show="entry.required && entry.required == '1'" style="font-size:8px;color:#B22222;vertical-align: middle;"></i> {{entry.label}}</h4> 
                <div ng-if="entry.type == 'string'">
                	<input type="text" class="form-control" name="{{entry.field}}" id="{{entry.field}}" ng-model="c.data[entry.field]">
                </div>
                <div ng-if="entry.type == 'checkbox'">
                	<div flex-xs flex="50">
                    <md-checkbox aria-label="Select All"
                                 ng-checked="c.isChecked(entry.field)"
                                 md-indeterminate="c.isIndeterminate(entry.field)"
                                 ng-click="c.toggleAll(entry.field)">
                      <span ng-if="c.isChecked(entry.field)">Un-</span>Select All
                    </md-checkbox>
                  </div>
                  <div class="submission-checkboxes" ng-repeat="item in entry.items track by $index">
                    <md-checkbox ng-if="item != ''" ng-checked="c.exists(item, c.selected[entry.field])" ng-click="c.toggle(item, c.selected[entry.field])">
                      {{ item }}
                    </md-checkbox>
                  </div>
                </div>
                <div ng-if="entry.type == 'boolean'">
                  <div class="submission-checkboxes">
                    <md-checkbox ng-model="c.data[entry.field]" aria-label="{{entry.label}}" ng-change="c.transform(entry.field, entry.displayWhenTrue,entry.displayWhenFalse);">
                    </md-checkbox>
                  </div>
                </div>
                <div ng-if="entry.type == 'date'">
                  <md-datepicker ng-model="c.data[entry.field]" md-placeholder="Enter date"></md-datepicker>
                </div>
                <div ng-if="entry.type == 'html'">
                  <!-- <input type="text" class="form-control" name="{{entry.field}}" id="{{entry.field}}" ng-model="c.data[entry.field]">
                  <textarea ui-tinymce="c.testMceOptions" ng-model="c.data[entry.field]"></textarea>
                   -->
                  <textarea aria-label="{{entry.field}}"
                            name="{{entry.field}}"
                            class="form-control"
                            ng-model="c.data[entry.field]"
                            ui-tinymce="c.mceOptions"
                            rows="5"
                       			>
                  </textarea>
                  <span style="color:darkgray; font-weight:bold;font-size: 14px;" ng-if="entry.field == 'x_26385_crs_kd_u_kb_name_s_of_file_s'">* Please add files to this <a target='_blank' href="https://nih.sharepoint.com/:f:/r/sites/GRP-NCI-CRS/Shared%20Documents/Analysis?csf=1&e=5Rp6CS">Analysis folder</a> (CRS Sharepoint).</span>
              
                </div>
                <div ng-if="entry.type == 'radio'">
                  <md-radio-group ng-model="c.data[entry.field]">
                    <md-radio-button class="submission-radios" value="{{item}}" ng-repeat="item in entry.items">{{item}}</md-radio-button>
                  </md-radio-group>
                </div>
                <div ng-if="entry.type == 'customize'">
                  <div ng-if="entry.label == 'References'">
                    <h5>
                      Please enter PMIDs (More than one PMID separated by commas)
                    </h5>
                    <div>
                      <input type="text" class="form-control" name="pmids" id="pmids" ng-model="c.data['pmids']">
                    </div>
                  </div>
                  <div ng-if="entry.label == 'Funding'">
                    <md-checkbox ng-model="c.data['Funding']" style="margin-bottom:5px;">
                      This study has no NCI funding
                    </md-checkbox>
                    <h5>
                      Funding information
                    </h5>
                    <div>
                      <input type="text" class="form-control" name="Funding_info" id="Funding_info" ng-model="c.data['Funding_info']">
                    </div>
                  </div>
                </div>
                <div ng-if="entry.type == 'file'">
                  <div style="margin-bottom:10px;">
                    <input type="file" style="width:80%;float:left;cursor: pointer;" name="file2upload" class="form-control">
                    <span class="attachment-action" ng-click="c.addAttachment($event)"><i class="fa fa-plus"></i></span>
                  	<span class="attachment-action" ng-click="c.deleteAttachment($event)" ng-show = "c.attachments.length > 1"><i class="fa fa-minus"></i></span>
                  </div>
                  <span style="color:darkgray;">PDF/PPT/Word only, Maximum upload size 18 MB.</span>
                </div>
              </div>
            </div>
            <div class="block-footer" style="text-align:center;">
              <!--<md-button class="md-raised" ng-show="c.save" ng-disabled="c.saving" style="background-color: #C6375D;color: white;">Submit</md-button> -->
              <md-button class="md-raised" ng-show="c.save" ng-disabled="c.saving" style="background-color: #C6375D;color: white;" ng-click="c.saveDraft()">{{c.save_text}}</md-button>
              <md-button class="md-raised" ng-disabled="c.saving" ng-click="c.goBacktoSubmissions()">Cancel</md-button>
            </div>
          </div>
		</div>
  </div>
</div>]]></template>
    </sp_widget>
</record_update>
